var selectImage=function(){"use strict";return function(e){var s=e.btnOkText,p=e.btnCancelText,f=e.selectDeviceText,h=e.videoWidth,g=e.videoHeight,t=e.forceFile,E=void 0!==t&&t,b=e.preferedDevice,C=(e.deviceConstraints,e.facingMode),x=e.cameraNameFormatter;return new Promise(function(i,t){var a={},e=navigator.getUserMedia;if(E||!e)return new Promise(function(i,e){var t=document.createElement("input");t.type="file",t.style.position="absolute",t.style.top="-100px",document.body.appendChild(t),t.addEventListener("change",function(e){var t=e.target.files[0],n=new FileReader;n.onload=function(e){return i(e.target.result)},n.readAsDataURL(t)}),t.accept="image/x-png,image/gif,image/jpeg",t.multiple=!1,t.click()}).then(i);var c=document.createElement("div"),o=document.createElement("video"),n=document.createElement("div"),r=document.createElement("button"),d=document.createElement("button"),l=document.createElement("select"),u=function(e){c.parentElement.removeChild(c),t(e)};l.className="camera-selection",navigator.mediaDevices.enumerateDevices().then(function(e){c.appendChild(l),l.innerHTML='<option value="">'+f+"</option>",e.filter(function(e){return-1!==(e.kind||"").indexOf("video")}).map(function(e,t){return{id:e.deviceId,name:x?x(e,t):e.label||"Video input",originalName:e.label||""}}).forEach(function(e,t){var n=document.createElement("option");n.textContent=e.name,n.value=e.id,b?-1!==e.originalName.indexOf(b)&&(n.selected=!0):0===t&&(n.selected=!0),l.appendChild(n)});var t=void 0;l.value&&(t={video:{deviceId:{exact:l.value}}}),m(t)}).catch(function(e){return u(e)}),r.textContent=s,d.textContent=p,d.className="cancel-btn",r.className="ok-btn",n.className="bottom-btns",n.appendChild(r),n.appendChild(d),c.appendChild(n);var v=function(e){a.getTracks().forEach(function(e){return e.stop()}),c.parentElement.removeChild(c)};d.addEventListener("click",v),r.addEventListener("click",function(e){var t=document.createElement("canvas");t.height=o.videoHeight,t.width=o.videoWidth,t.getContext("2d").drawImage(o,0,0,t.width,t.height);var n=t.toDataURL();v(),i(n)}),c.classList.add("camera-fullscreen"),document.body.appendChild(c);var m=function(t){(t=t||{}).video=t.video||{},h&&(t.video.width={min:h}),g&&(t.video.height={min:g});var n=function(e){a=e,o.autoplay=!0,c.appendChild(o),"srcObject"in o?(o.srcObject=e,o.setAttribute("playsinline",""),o.play()):o.src=window.URL.createObjectURL(e)};try{navigator.mediaDevices.getUserMedia({video:!C||{facingMode:C}}).then(n).catch(function(e){return u(e)})}catch(e){navigator.getUserMedia(t,n,function(e){return u(e)})}};l.addEventListener("change",function(e){a.getTracks().forEach(function(e){return e.stop()});var t={deviceId:{exact:l.value}};h&&(t.width={min:h}),m({video:t})})})}}();
