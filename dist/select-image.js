var selectImage=function(){"use strict";return function(e){var m=e.btnOkText,s=e.btnCancelText,p=e.selectDeviceText,f=e.videoWidth,h=e.videoHeight,t=e.forceFile,g=void 0!==t&&t,E=e.preferedDevice;e.deviceConstraints;return new Promise(function(i,e){var n={},t=navigator.getUserMedia;if(g||!t)return new Promise(function(i,e){var t=document.createElement("input");t.type="file",t.style.position="absolute",t.style.top="-100px",document.body.appendChild(t),t.addEventListener("change",function(e){var t=e.target.files[0],n=new FileReader;n.onload=function(e){return i(e.target.result)},n.readAsDataURL(t)}),t.accept="image/x-png,image/gif,image/jpeg",t.multiple=!1,t.click()}).then(i);var a=document.createElement("div"),o=document.createElement("video"),c=document.createElement("div"),d=document.createElement("button"),r=document.createElement("button"),l=document.createElement("select");l.className="camera-selection",navigator.mediaDevices.enumerateDevices().then(function(e){a.appendChild(l),l.innerHTML='<option value="">'+p+"</option>",e.filter(function(e){return-1!==(e.kind||"").indexOf("video")}).map(function(e){return{id:e.deviceId,name:e.label||"Video input"}}).forEach(function(e){var t=document.createElement("option");t.textContent=e.name,t.value=e.id,E&&-1!==e.name.indexOf(E)&&(t.selected=!0),l.appendChild(t)});var t=void 0;l.value&&(t={video:{deviceId:{exact:l.value}}}),v(t)}),d.textContent=m,r.textContent=s,r.className="cancel-btn",d.className="ok-btn",c.className="bottom-btns",c.appendChild(d),c.appendChild(r),a.appendChild(c);var u=function(e){n.getTracks().forEach(function(e){return e.stop()}),a.parentElement.removeChild(a)};r.addEventListener("click",u),d.addEventListener("click",function(e){var t=document.createElement("canvas");t.height=o.videoHeight,t.width=o.videoWidth,t.getContext("2d").drawImage(o,0,0,t.width,t.height);var n=t.toDataURL();u(),i(n)}),a.classList.add("camera-fullscreen"),document.body.appendChild(a);var v=function(e){(e=e||{}).video=e.video||{},f&&(e.video.width={min:f}),h&&(e.video.height={min:h}),navigator.getUserMedia(e,function(e){n=e,o.autoplay=!0,a.appendChild(o),o.src=window.URL.createObjectURL(e)},function(){console.log("on fail")})};l.addEventListener("change",function(e){n.getTracks().forEach(function(e){return e.stop()});var t={deviceId:{exact:l.value}};f&&(t.width={min:f}),v({video:t})})})}}();
